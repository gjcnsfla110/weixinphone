{"version":3,"file":"u-popup.js","sources":["node_modules/uview-pro/components/u-popup/u-popup.vue","/Users/Coding/uniapp/weixinphone/node_modules/uview-pro/components/u-popup/u-popup.vue?type=component"],"sourcesContent":["<template>\n    <view\n        v-if=\"visibleSync\"\n        :style=\"[customStyle, { zIndex: Number(uZindex) - 1 }]\"\n        class=\"u-drawer\"\n        hover-stop-propagation\n    >\n        <u-mask\n            :duration=\"duration\"\n            :custom-style=\"maskCustomStyle\"\n            :maskClickAble=\"maskCloseAble\"\n            :z-index=\"Number(uZindex) - 2\"\n            :show=\"showDrawer && mask\"\n            @click=\"maskClick\"\n        ></u-mask>\n        <view\n            class=\"u-drawer-content\"\n            @tap=\"modeCenterClose(mode)\"\n            :class=\"[\n                safeAreaInsetBottom ? 'safe-area-inset-bottom' : '',\n                'u-drawer-' + mode,\n                showDrawer ? 'u-drawer-content-visible' : '',\n                zoom && mode == 'center' ? 'u-animation-zoom' : ''\n            ]\"\n            @touchmove.stop.prevent\n            @tap.stop.prevent\n            :style=\"[style]\"\n        >\n            <view\n                class=\"u-mode-center-box\"\n                @tap.stop.prevent\n                @touchmove.stop.prevent\n                v-if=\"mode == 'center'\"\n                :style=\"[centerStyle]\"\n            >\n                <u-icon\n                    @click=\"close\"\n                    v-if=\"closeable\"\n                    class=\"u-close\"\n                    :class=\"['u-close--' + closeIconPos]\"\n                    :name=\"closeIcon\"\n                    :color=\"closeIconColor\"\n                    :size=\"closeIconSize\"\n                ></u-icon>\n                <scroll-view class=\"u-drawer__scroll-view\" scroll-y=\"true\">\n                    <slot />\n                </scroll-view>\n            </view>\n            <scroll-view class=\"u-drawer__scroll-view\" scroll-y=\"true\" v-else>\n                <slot />\n            </scroll-view>\n            <view @tap=\"close\" class=\"u-close\" :class=\"['u-close--' + closeIconPos]\">\n                <u-icon\n                    v-if=\"mode != 'center' && closeable\"\n                    :name=\"closeIcon\"\n                    :color=\"closeIconColor\"\n                    :size=\"closeIconSize\"\n                ></u-icon>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, onMounted, nextTick } from 'vue';\nimport { $u } from '../..';\nimport { PopupProps } from './types';\n\ndefineOptions({\n    name: 'u-popup'\n});\n\n/**\n * popup 弹窗\n * @description 弹出层容器，用于展示弹窗、信息提示等内容，支持上、下、左、右和中部弹出。组件只提供容器，内部内容由用户自定义\n * @tutorial https://uviewpro.cn/zh/components/popup.html\n * @property {String} mode 弹出方向（默认left）\n * @property {Boolean} mask 是否显示遮罩（默认true）\n * @property {Stringr | Number} length mode=left | 见官网说明（默认auto）\n * @property {Boolean} zoom 是否开启缩放动画，只在mode为center时有效（默认true）\n * @property {Boolean} safe-area-inset-bottom 是否开启底部安全区适配（默认false）\n * @property {Boolean} mask-close-able 点击遮罩是否可以关闭弹出层（默认true）\n * @property {Object} custom-style 用户自定义样式\n * @property {Stringr | Number} negative-top 中部弹出时，往上偏移的值\n * @property {Numberr | String} border-radius 弹窗圆角值（默认0）\n * @property {Numberr | String} z-index 弹出内容的z-index值（默认1075）\n * @property {Boolean} closeable 是否显示关闭图标（默认false）\n * @property {String} close-icon 关闭图标的名称，只能uView的内置图标\n * @property {String} close-icon-pos 自定义关闭图标位置（默认top-right）\n * @property {String} close-icon-color 关闭图标的颜色（默认#909399）\n * @property {Number | String} close-icon-size 关闭图标的大小，单位rpx（默认30）\n * @event {Function} open 弹出层打开\n * @event {Function} close 弹出层收起\n * @example <u-popup v-model=\"show\"><view>出淤泥而不染，濯清涟而不妖</view></u-popup>\n */\n\nconst props = defineProps(PopupProps);\nconst emit = defineEmits(['update:modelValue', 'open', 'close']);\n\n// 组件内部状态\nconst visibleSync = ref(false);\nconst showDrawer = ref(false);\nconst timer = ref<ReturnType<typeof setTimeout> | null>(null);\nconst closeFromInner = ref(false); // value的值改变，是发生在内部还是外部\n// 根据mode的位置，设定其弹窗的宽度(mode = left|right)，或者高度(mode = top|bottom)\nconst style = computed(() => {\n    let style: Record<string, any> = {};\n    // 如果是左边或者上边弹出时，需要给translate设置为负值，用于隐藏\n    if (props.mode == 'left' || props.mode == 'right') {\n        style = {\n            width: props.width ? getUnitValue(props.width) : getUnitValue(props.length),\n            height: '100%',\n            transform: `translate3D(${props.mode == 'left' ? '-100%' : '100%'},0px,0px)`\n        };\n    } else if (props.mode == 'top' || props.mode == 'bottom') {\n        style = {\n            width: '100%',\n            height: props.height ? getUnitValue(props.height) : getUnitValue(props.length),\n            transform: `translate3D(0px,${props.mode == 'top' ? '-100%' : '100%'},0px)`\n        };\n    }\n    // 如果用户设置了borderRadius值，添加弹窗的圆角\n    style.zIndex = uZindex.value;\n    if (props.borderRadius) {\n        switch (props.mode) {\n            case 'left':\n                style.borderRadius = `0 ${props.borderRadius}rpx ${props.borderRadius}rpx 0`;\n                break;\n            case 'top':\n                style.borderRadius = `0 0 ${props.borderRadius}rpx ${props.borderRadius}rpx`;\n                break;\n            case 'right':\n                style.borderRadius = `${props.borderRadius}rpx 0 0 ${props.borderRadius}rpx`;\n                break;\n            case 'bottom':\n                style.borderRadius = `${props.borderRadius}rpx ${props.borderRadius}rpx 0 0`;\n                break;\n            default:\n        }\n        // 不加可能圆角无效\n        style.overflow = 'hidden';\n    }\n    if (props.duration) style.transition = `all ${Number(props.duration) / 1000}s linear`;\n    return style;\n});\n\n// 中部弹窗的特有样式\nconst centerStyle = computed(() => {\n    let style: Record<string, any> = {};\n    style.width = props.width ? getUnitValue(props.width) : getUnitValue(props.length);\n\n    // 中部弹出的模式，如果没有设置高度，就用auto值，由内容撑开高度\n    style.height = props.height ? getUnitValue(props.height) : 'auto';\n    style.zIndex = uZindex.value;\n    style.marginTop = `-${$u.addUnit(props.negativeTop)}`;\n    if (props.borderRadius) {\n        style.borderRadius = `${props.borderRadius}rpx`;\n        // 不加可能圆角无效\n        style.overflow = 'hidden';\n    }\n    return style;\n});\n\n// 计算整理后的z-index值\nconst uZindex = computed(() => (props.zIndex ? props.zIndex : $u.zIndex.popup));\n\nwatch(\n    () => props.modelValue,\n    val => {\n        if (val) {\n            open();\n        } else if (!closeFromInner.value) {\n            close();\n        }\n        closeFromInner.value = false;\n    }\n);\n\nonMounted(() => {\n    if (props.modelValue) open();\n});\n\n/**\n * 判断传入的值，是否带有单位，如果没有，就默认用rpx单位\n */\nfunction getUnitValue(val: string | number) {\n    if (/(%|px|rpx|auto)$/.test(String(val))) return val;\n    else return val + 'rpx';\n}\n\n/**\n * 遮罩被点击\n */\nfunction maskClick() {\n    close();\n}\n\n/**\n * 关闭弹窗\n */\nfunction close() {\n    // 标记关闭是内部发生的，否则修改了value值，导致watch中对value检测，导致再执行一遍close\n    // 造成@close事件触发两次\n    closeFromInner.value = true;\n    change('showDrawer', 'visibleSync', false);\n}\n\n/**\n * 中部弹出时，点击内容区域关闭弹窗\n */\nfunction modeCenterClose(mode: string) {\n    // 中部弹出时，需要.u-drawer-content将居中内容，此元素会铺满屏幕，点击需要关闭弹窗\n    // 让其只在mode=center时起作用\n    if (mode != 'center' || !props.maskCloseAble) return;\n    close();\n}\n\n/**\n * 打开弹窗\n */\nfunction open() {\n    change('visibleSync', 'showDrawer', true);\n}\n\n/**\n * 控制弹窗显示/隐藏的动画和状态\n * 此处的原理是，关闭时先通过动画隐藏弹窗和遮罩，再移除整个组件\n * 打开时，先渲染组件，延时一定时间再让遮罩和弹窗的动画起作用\n */\nfunction change(param1: 'showDrawer' | 'visibleSync', param2: 'visibleSync' | 'showDrawer', status: boolean) {\n    // 如果this.popup为false，意味着为picker，actionsheet等组件调用了popup组件\n    if (props.popup === true) {\n        emit('update:modelValue', status);\n    }\n    (param1 === 'showDrawer' ? showDrawer : visibleSync).value = status;\n    if (status) {\n\n        timer.value = setTimeout(() => {\n            (param2 === 'showDrawer' ? showDrawer : visibleSync).value = status;\n            emit(status ? 'open' : 'close');\n        }, 50);\n\n\n\n\n\n\n\n    } else {\n        timer.value = setTimeout(() => {\n            (param2 === 'showDrawer' ? showDrawer : visibleSync).value = status;\n            emit(status ? 'open' : 'close');\n        }, Number(props.duration));\n    }\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import '../../libs/css/style.components.scss';\n\n.u-drawer {\n\n    display: block;\n\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n\n.u-drawer-content {\n\n    display: block;\n\n    position: absolute;\n    z-index: 1003;\n    transition: all 0.25s linear;\n}\n\n.u-drawer__scroll-view {\n    width: 100%;\n    height: 100%;\n}\n\n.u-drawer-left {\n    top: 0;\n    bottom: 0;\n    left: 0;\n    background-color: #ffffff;\n}\n\n.u-drawer-right {\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: #ffffff;\n}\n\n.u-drawer-top {\n    top: 0;\n    left: 0;\n    right: 0;\n    background-color: #ffffff;\n}\n\n.u-drawer-bottom {\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background-color: #ffffff;\n}\n\n.u-drawer-center {\n    @include vue-flex;\n    flex-direction: column;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    top: 0;\n    justify-content: center;\n    align-items: center;\n    opacity: 0;\n    z-index: 99999;\n}\n\n.u-mode-center-box {\n    min-width: 100rpx;\n    min-height: 100rpx;\n\n    display: block;\n\n    position: relative;\n    background-color: #ffffff;\n}\n\n.u-drawer-content-visible.u-drawer-center {\n    transform: scale(1);\n    opacity: 1;\n}\n\n.u-animation-zoom {\n    transform: scale(1.15);\n}\n\n.u-drawer-content-visible {\n    transform: translate3D(0px, 0px, 0px) !important;\n}\n\n.u-close {\n    position: absolute;\n    z-index: 3;\n}\n\n.u-close--top-left {\n    top: 30rpx;\n    left: 30rpx;\n}\n\n.u-close--top-right {\n    top: 30rpx;\n    right: 30rpx;\n}\n\n.u-close--bottom-left {\n    bottom: 30rpx;\n    left: 30rpx;\n}\n\n.u-close--bottom-right {\n    right: 30rpx;\n    bottom: 30rpx;\n}\n</style>\n","import Component from '/Users/Coding/uniapp/weixinphone/node_modules/uview-pro/components/u-popup/u-popup.vue'\nwx.createComponent(Component)"],"names":["ref","computed","style","$u","watch","onMounted"],"mappings":"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","x_google_ignoreList":[0]}